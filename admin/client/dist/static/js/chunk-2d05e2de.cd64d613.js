(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d05e2de"],{"06c5":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("fb6a"),a("d3b7"),a("25f0"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f"),a("00b4");var n=a("6b75");function r(e,t){if(e){if("string"===typeof e)return Object(n["a"])(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(n["a"])(e,t):void 0}}},"25f0":function(e,t,a){"use strict";var n=a("6eeb"),r=a("825a"),i=a("d039"),o=a("ad6d"),s="toString",l=RegExp.prototype,c=l[s],u=i((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d=c.name!=s;(u||d)&&n(RegExp.prototype,s,(function(){var e=r(this),t=String(e.source),a=e.flags,n=String(void 0===a&&e instanceof RegExp&&!("flags"in l)?o.call(e):a);return"/"+t+"/"+n}),{unsafe:!0})},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a("6b75");function r(e){if(Array.isArray(e))return Object(n["a"])(e)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function i(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var o=a("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return r(e)||i(e)||Object(o["a"])(e)||s()}},"466d":function(e,t,a){"use strict";var n=a("d784"),r=a("825a"),i=a("50c4"),o=a("1d80"),s=a("8aa5"),l=a("14c3");n("match",1,(function(e,t,a){return[function(t){var a=o(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,a):new RegExp(t)[e](String(a))},function(e){var n=a(t,e,this);if(n.done)return n.value;var o=r(e),c=String(this);if(!o.global)return l(o,c);var u=o.unicode;o.lastIndex=0;var d,f=[],p=0;while(null!==(d=l(o,c))){var g=String(d[0]);f[p]=g,""===g&&(o.lastIndex=s(c,i(o.lastIndex),u)),p++}return 0===p?null:f}]}))},"4df4":function(e,t,a){"use strict";var n=a("0366"),r=a("7b0b"),i=a("9bdd"),o=a("e95a"),s=a("50c4"),l=a("8418"),c=a("35a1");e.exports=function(e){var t,a,u,d,f,p,g=r(e),h="function"==typeof this?this:Array,b=arguments.length,m=b>1?arguments[1]:void 0,v=void 0!==m,x=c(g),y=0;if(v&&(m=n(m,b>2?arguments[2]:void 0,2)),void 0==x||h==Array&&o(x))for(t=s(g.length),a=new h(t);t>y;y++)p=v?m(g[y],y):g[y],l(a,y,p);else for(d=x.call(g),f=d.next,a=new h;!(u=f.call(d)).done;y++)p=v?i(d,m,[u.value,y],!0):u.value,l(a,y,p);return a.length=y,a}},"4e82":function(e,t,a){"use strict";var n=a("23e7"),r=a("1c0b"),i=a("7b0b"),o=a("d039"),s=a("a640"),l=[],c=l.sort,u=o((function(){l.sort(void 0)})),d=o((function(){l.sort(null)})),f=s("sort"),p=u||!d||!f;n({target:"Array",proto:!0,forced:p},{sort:function(e){return void 0===e?c.call(i(this)):c.call(i(this),r(e))}})},"6b75":function(e,t,a){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}a.d(t,"a",(function(){return n}))},"704e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("el-row",{attrs:{gutter:0}},[t("el-col",{attrs:{span:4}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择日志"},model:{value:e.logName,callback:function(t){e.logName=t},expression:"logName"}},e._l(e.logNameList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-col",{attrs:{span:4}},[t("label",[e._v("导出格式:")]),t("el-select",{staticStyle:{width:"120px"},model:{value:e.bookType,callback:function(t){e.bookType=t},expression:"bookType"}},e._l(e.bookTypeOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t("el-col",{attrs:{span:3}},[t("el-button",{staticStyle:{margin:"0 0 20px 20px"},attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-document"},on:{click:e.handleDownload}},[e._v(" "+e._s(e.downloadText)+" ")])],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:4}},[t("div",[t("el-input",{attrs:{placeholder:"服务类型"},model:{value:e.setSvrType,callback:function(t){e.setSvrType=t},expression:"setSvrType"}}),t("el-input",{attrs:{placeholder:"服务ID"},model:{value:e.setSvrId,callback:function(t){e.setSvrId=t},expression:"setSvrId"}})],1)]),t("el-col",{attrs:{span:6}},[t("div",[t("el-date-picker",{attrs:{type:"datetimerange","value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.setTimeValue,callback:function(t){e.setTimeValue=t},expression:"setTimeValue"}})],1)]),e._l(e.indexs_list,(function(a){return t("el-col",{key:a.key,attrs:{span:4}},[t("div",e._l(a.list,(function(a){return t("el-input",{key:a,attrs:{placeholder:a},model:{value:e.indexs_value[a],callback:function(t){e.$set(e.indexs_value,a,t)},expression:"indexs_value[it]"}})})),1)])}))],2),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"",data:e.data_list,height:"600"}},e._l(e.field_list,(function(a){return t("el-table-column",{key:a,attrs:{label:a,resizable:"","min-width":"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.parseItemShow(a,t.row[a]))+" ")]}}],null,!0)})})),1)],1),t("div",{staticStyle:{"padding-top":"15px"},attrs:{align:"center"}},[t("el-button-group",[t("el-button",{attrs:{loading:e.loadingFirst,type:"primary",icon:"el-icon-arrow-left"},on:{click:e.onClickFirst}},[e._v("首页")]),t("el-button",{attrs:{loading:e.loadingPre,type:"primary",icon:"el-icon-arrow-left"},on:{click:e.onClickPre}},[e._v("上一页")]),t("el-button",{attrs:{loading:e.loadingNext,type:"primary"},on:{click:e.onClickNext}},[e._v("下一页"),t("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),t("p",[e._v(e._s(this.pagenum+"/"+this.totalPageNum))])],1)],1)},r=[],i=a("2909"),o=a("53ca"),s=a("ade3"),l=a("c7eb"),c=a("1da1"),u=(a("4e82"),a("a9e3"),a("ac1f"),a("466d"),a("5319"),a("d81d"),a("caad"),a("2532"),a("e9c4"),a("d3b7"),a("3ca3"),a("ddb0"),a("99af"),a("b775"));function d(){return Object(u["a"])({url:"/log_pannel/log_name_list",method:"get"})}function f(e){return Object(u["a"])({url:"/log_pannel/log_desc/".concat(e),method:"get"})}function p(e){return Object(u["a"])({url:"/log_pannel/log_list",method:"post",data:e})}var g={data:function(){return{pagecount:20,count:0,totalPageNum:0,logNameList:[],field_list:[],field_map:{},indexs_list:[],indexs_value:{},logName:"",pagenum:1,pageCachMap:{},data_list:[],cursor:null,nextOffset:0,setSvrType:"",setSvrId:"",setTimeValue:"",loadingFirst:!1,loadingPre:!1,loadingNext:!1,downloadLoading:!1,downloadProgress:0,bookType:"xlsx",bookTypeOptions:["xlsx","csv"]}},computed:{downloadText:function(){return this.downloadLoading?"导出中 ".concat(this.downloadProgress,"%"):"导出数据"}},created:function(){this.getLogNameList()},watch:{logName:{handler:function(e){this.getLogInfo(e),this.clearData(),this.getLogList()}}},methods:{clearData:function(){this.pageCachMap={},this.pagenum=1,this.totalPageNum=0,this.cursor=null,this.data_list=[],this.setSvrType="",this.setSvrId="",this.setTimeValue="",this.indexs_value={},this.field_map={}},getLogNameList:function(){var e=this;return Object(c["a"])(Object(l["a"])().mark((function t(){var a,n,r;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d();case 2:if(a=t.sent,Array.isArray(a.data))for(e.logNameList=[],n=0;n<a.data.length;n++)r=a.data[n],e.logNameList[n]={label:"label:"+r,value:r};else e.logNameList=[];case 4:case"end":return t.stop()}}),t)})))()},getLogInfo:function(e){var t=this;return Object(c["a"])(Object(l["a"])().mark((function a(){var n,r,i,o,s;return Object(l["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,f(e);case 2:for(n=a.sent,console.log("res >>> ",n),t.field_list=[],r=0;r<n.data.field_list.length;r++)i=n.data.field_list[r],"_log_name"!=i&&t.field_list.push(i);for(o in t.indexs_list=[],n.data.indexs_list)s=n.data.indexs_list[o],"time_index"!=o&&"svr_index"!=o&&t.indexs_list.push({key:o,list:s});t.indexs_list.sort((function(e,t){return e.key-t.key})),t.field_map=n.data.field_map;case 10:case"end":return a.stop()}}),a)})))()},buildQuery:function(){var e,t={};(""==this.setSvrType||isNaN(Number(this.setSvrType))||(t._svr_type=Number(this.setSvrType)),""==this.setSvrId||isNaN(Number(this.setSvrId))||(t._svr_id=Number(this.setSvrId)),this.setTimeValue)&&(t._time=(e={},Object(s["a"])(e,"$gte",Math.floor(this.setTimeValue[0]/1e3)),Object(s["a"])(e,"$lte",Math.floor(this.setTimeValue[1]/1e3)),e));for(var a in this.indexs_value){var n=this.indexs_value[a];if(""!=n){var r=this.field_map[a];if(r<20){var i,o=(null===(i=n.replace(/\s+/g,"").match(/-?\d+/g))||void 0===i?void 0:i.map(Number))||[],l=n.match(/(>=|<=|>|<)/g)||[];isNaN(Number(n))||(t[a]=Number(n));for(var c=o.length,u=0;u<c;u++){var d=o[u],f=l[u];f?(t[a]||(t[a]={}),">"==f?t[a]["$gt"]=d:">="==f?t[a]["$gte"]=d:"<="==f?t[a]["$lte"]=d:"<"==f?t[a]["$lt"]=d:delete t[a]):t[a]=d}}else t[a]=n}}return t},getLogList:function(){var e=this;return Object(c["a"])(Object(l["a"])().mark((function t(){var a,n,r;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1==e.pagenum||!e.pageCachMap[e.pagenum]){t.next=3;break}return e.data_list=e.pageCachMap[e.pagenum],t.abrupt("return");case 3:return 1==e.pagenum&&(e.pageCachMap={},e.cursor=null,e.nextOffset=0),a=e.buildQuery(),t.next=7,p({logname:e.logName,pagenum:e.pagenum,cursor:e.cursor,query:a,next_offset:e.nextOffset});case 7:return n=t.sent,r=n.data,e.cursor=r.cursor,e.pagenum=r.pagenum,e.nextOffset=r.next_offset,r.count&&(e.count=r.count,e.totalPageNum=Math.ceil(e.count/e.pagecount)),Array.isArray(r.list)?e.data_list=r.list:e.data_list=[],e.pageCachMap[e.pagenum]=e.data_list,t.abrupt("return",r);case 16:case"end":return t.stop()}}),t)})))()},fetchPageData:function(e,t,a){var n=this;return Object(c["a"])(Object(l["a"])().mark((function r(){var i,o;return Object(l["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i=n.buildQuery(),r.next=3,p({logname:n.logName,pagenum:e,cursor:t,query:i,next_offset:a});case 3:return o=r.sent,r.abrupt("return",o.data);case 5:case"end":return r.stop()}}),r)})))()},parseItemShow:function(e,t){return e.includes("time")?new Date(1e3*t).toLocaleString("zh-CN"):"object"==Object(o["a"])(t)?JSON.stringify(t):""+t},onClickFirst:function(){var e=this;return Object(c["a"])(Object(l["a"])().mark((function t(){return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.cursor=null,e.pagenum=1,e.data_list=[],e.loadingFirst=!0,t.next=6,e.getLogList();case 6:e.loadingFirst=!1;case 7:case"end":return t.stop()}}),t)})))()},onClickPre:function(){var e=this;return Object(c["a"])(Object(l["a"])().mark((function t(){return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.pagenum<=1)){t.next=3;break}return e.$notify({title:"已经到第一页了"}),t.abrupt("return");case 3:return e.pagenum-=1,e.data_list=[],e.loadingPre=!0,t.next=8,e.getLogList();case 8:e.loadingPre=!1;case 9:case"end":return t.stop()}}),t)})))()},onClickNext:function(){var e=this;return Object(c["a"])(Object(l["a"])().mark((function t(){return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.pagenum>=e.totalPageNum)){t.next=3;break}return e.$notify({title:"已经到最后一页了"}),t.abrupt("return");case 3:return e.pagenum+=1,e.data_list=[],e.loadingNext=!0,t.next=8,e.getLogList();case 8:e.loadingNext=!1;case 9:case"end":return t.stop()}}),t)})))()},handleDownload:function(){var e=this;return Object(c["a"])(Object(l["a"])().mark((function t(){var n,r,o,s,c,u,d,f,p,g,h,b;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.downloadLoading){t.next=3;break}return e.$notify.warning({title:"提示",message:"正在导出中，请稍候..."}),t.abrupt("return");case 3:if(0!==e.totalPageNum){t.next=6;break}return e.$notify.warning({title:"提示",message:"暂无数据可导出"}),t.abrupt("return");case 6:if(n=e.count,!(n>1e4)){t.next=13;break}return t.next=10,e.$confirm("当前共有 ".concat(n," 条数据，导出可能需要较长时间，是否继续？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(){return!1}));case 10:if(r=t.sent,r){t.next=13;break}return t.abrupt("return");case 13:e.downloadLoading=!0,e.downloadProgress=0,t.prev=15,o=e.pagenum,s=e.cursor,c=e.nextOffset,u=[],d=null,f=0,p=1;case 23:if(!(p<=e.totalPageNum)){t.next=38;break}if(!e.pageCachMap[p]){t.next=28;break}u.push.apply(u,Object(i["a"])(e.pageCachMap[p])),t.next=34;break;case 28:return t.next=30,e.fetchPageData(p,d,f);case 30:g=t.sent,Array.isArray(g.list)&&g.list.length>0&&(u.push.apply(u,Object(i["a"])(g.list)),e.pageCachMap[p]=g.list),d=g.cursor,f=g.next_offset;case 34:e.downloadProgress=Math.floor(p/e.totalPageNum*100);case 35:p++,t.next=23;break;case 38:return e.pagenum=o,e.cursor=s,e.nextOffset=c,console.log("导出数据总数:",u.length),h=e.formatJson(e.field_list,u),t.next=45,Promise.all([a.e("chunk-5ed393f0"),a.e("chunk-2133cd4f")]).then(a.bind(null,"4bf8"));case 45:b=t.sent,b.export_json_to_excel({header:e.field_list,data:h,filename:"".concat(e.logName,"_").concat((new Date).toLocaleDateString()),autoWidth:!0,bookType:e.bookType}),e.$notify.success({title:"成功",message:"成功导出 ".concat(u.length," 条数据")}),t.next=54;break;case 50:t.prev=50,t.t0=t["catch"](15),console.error("导出失败:",t.t0),e.$notify.error({title:"导出失败",message:t.t0.message||"导出过程中发生错误"});case 54:return t.prev=54,e.downloadLoading=!1,e.downloadProgress=0,t.finish(54);case 58:case"end":return t.stop()}}),t,null,[[15,50,54,58]])})))()},formatJson:function(e,t){var a=this;return t.map((function(t){return e.map((function(e){return a.parseItemShow(e,t[e])}))}))}}},h=g,b=a("2877"),m=Object(b["a"])(h,n,r,!1,null,null,null);t["default"]=m.exports},a630:function(e,t,a){var n=a("23e7"),r=a("4df4"),i=a("1c7e"),o=!i((function(e){Array.from(e)}));n({target:"Array",stat:!0,forced:o},{from:r})},e9c4:function(e,t,a){var n=a("23e7"),r=a("d066"),i=a("d039"),o=r("JSON","stringify"),s=/[\uD800-\uDFFF]/g,l=/^[\uD800-\uDBFF]$/,c=/^[\uDC00-\uDFFF]$/,u=function(e,t,a){var n=a.charAt(t-1),r=a.charAt(t+1);return l.test(e)&&!c.test(r)||c.test(e)&&!l.test(n)?"\\u"+e.charCodeAt(0).toString(16):e},d=i((function(){return'"\\udf06\\ud834"'!==o("\udf06\ud834")||'"\\udead"'!==o("\udead")}));o&&n({target:"JSON",stat:!0,forced:d},{stringify:function(e,t,a){var n=o.apply(null,arguments);return"string"==typeof n?n.replace(s,u):n}})}}]);